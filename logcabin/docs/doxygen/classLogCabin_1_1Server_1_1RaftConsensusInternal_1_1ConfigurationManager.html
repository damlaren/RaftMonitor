<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.7"/>
<title>LogCabin: LogCabin::Server::RaftConsensusInternal::ConfigurationManager Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">LogCabin
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.7 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespaceLogCabin.html">LogCabin</a></li><li class="navelem"><a class="el" href="namespaceLogCabin_1_1Server.html">Server</a></li><li class="navelem"><a class="el" href="namespaceLogCabin_1_1Server_1_1RaftConsensusInternal.html">RaftConsensusInternal</a></li><li class="navelem"><a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1ConfigurationManager.html">ConfigurationManager</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="#friends">Friends</a> &#124;
<a href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1ConfigurationManager-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">LogCabin::Server::RaftConsensusInternal::ConfigurationManager Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Ensures the current configuration reflects the latest state of the log and snapshot.  
 <a href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1ConfigurationManager.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="RaftConsensus_8h_source.html">RaftConsensus.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a20dde8951e005beb38d1fc337042e1e3"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1ConfigurationManager.html#a20dde8951e005beb38d1fc337042e1e3">ConfigurationManager</a> (<a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Configuration.html">Configuration</a> &amp;<a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1ConfigurationManager.html#a855381f65214fe24d258989b099e0ddc">configuration</a>)</td></tr>
<tr class="memdesc:a20dde8951e005beb38d1fc337042e1e3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor.  <a href="#a20dde8951e005beb38d1fc337042e1e3">More...</a><br /></td></tr>
<tr class="separator:a20dde8951e005beb38d1fc337042e1e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb9e78257346313f89d479aad1cf360f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1ConfigurationManager.html#abb9e78257346313f89d479aad1cf360f">~ConfigurationManager</a> ()</td></tr>
<tr class="memdesc:abb9e78257346313f89d479aad1cf360f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor.  <a href="#abb9e78257346313f89d479aad1cf360f">More...</a><br /></td></tr>
<tr class="separator:abb9e78257346313f89d479aad1cf360f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aff783eca177f6fbbc4d3bd6d799859c0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1ConfigurationManager.html#aff783eca177f6fbbc4d3bd6d799859c0">add</a> (uint64_t index, const Protocol::Raft::Configuration &amp;description)</td></tr>
<tr class="memdesc:aff783eca177f6fbbc4d3bd6d799859c0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Called when a new configuration is added to the log.  <a href="#aff783eca177f6fbbc4d3bd6d799859c0">More...</a><br /></td></tr>
<tr class="separator:aff783eca177f6fbbc4d3bd6d799859c0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9f31a1182a01209770403dbb49423476"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1ConfigurationManager.html#a9f31a1182a01209770403dbb49423476">truncatePrefix</a> (uint64_t firstIndexKept)</td></tr>
<tr class="memdesc:a9f31a1182a01209770403dbb49423476"><td class="mdescLeft">&#160;</td><td class="mdescRight">Called when a log prefix is truncated (after saving a snapshot that covers this prefix).  <a href="#a9f31a1182a01209770403dbb49423476">More...</a><br /></td></tr>
<tr class="separator:a9f31a1182a01209770403dbb49423476"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2dc9ed6d199ba92faaeabf99f3f92e11"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1ConfigurationManager.html#a2dc9ed6d199ba92faaeabf99f3f92e11">truncateSuffix</a> (uint64_t lastIndexKept)</td></tr>
<tr class="memdesc:a2dc9ed6d199ba92faaeabf99f3f92e11"><td class="mdescLeft">&#160;</td><td class="mdescRight">Called when a log suffix is truncated (when the leader doesn't agree with this server's log).  <a href="#a2dc9ed6d199ba92faaeabf99f3f92e11">More...</a><br /></td></tr>
<tr class="separator:a2dc9ed6d199ba92faaeabf99f3f92e11"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9f2af8ae5b725e85ec6bccd788538ab9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1ConfigurationManager.html#a9f2af8ae5b725e85ec6bccd788538ab9">setSnapshot</a> (uint64_t index, const Protocol::Raft::Configuration &amp;description)</td></tr>
<tr class="memdesc:a9f2af8ae5b725e85ec6bccd788538ab9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Called when a new snapshot is saved.  <a href="#a9f2af8ae5b725e85ec6bccd788538ab9">More...</a><br /></td></tr>
<tr class="separator:a9f2af8ae5b725e85ec6bccd788538ab9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb27d1a3e2260fb6cca1c8367c98d3a4"><td class="memItemLeft" align="right" valign="top">std::pair&lt; uint64_t, <br class="typebreak" />
Protocol::Raft::Configuration &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1ConfigurationManager.html#aeb27d1a3e2260fb6cca1c8367c98d3a4">getLatestConfigurationAsOf</a> (uint64_t lastIncludedIndex) const </td></tr>
<tr class="memdesc:aeb27d1a3e2260fb6cca1c8367c98d3a4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the configuration as of a particular log index.  <a href="#aeb27d1a3e2260fb6cca1c8367c98d3a4">More...</a><br /></td></tr>
<tr class="separator:aeb27d1a3e2260fb6cca1c8367c98d3a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a4e4d61fe51a62f8293d4a5667d68a1cc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1ConfigurationManager.html#a4e4d61fe51a62f8293d4a5667d68a1cc">restoreInvariants</a> ()</td></tr>
<tr class="memdesc:a4e4d61fe51a62f8293d4a5667d68a1cc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Helper function called after changing this object's state.  <a href="#a4e4d61fe51a62f8293d4a5667d68a1cc">More...</a><br /></td></tr>
<tr class="separator:a4e4d61fe51a62f8293d4a5667d68a1cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a855381f65214fe24d258989b099e0ddc"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Configuration.html">Configuration</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1ConfigurationManager.html#a855381f65214fe24d258989b099e0ddc">configuration</a></td></tr>
<tr class="memdesc:a855381f65214fe24d258989b099e0ddc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Defines the servers that are part of the cluster.  <a href="#a855381f65214fe24d258989b099e0ddc">More...</a><br /></td></tr>
<tr class="separator:a855381f65214fe24d258989b099e0ddc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1b0e9174e1e054fdb2f6ec398575900b"><td class="memItemLeft" align="right" valign="top">std::map&lt; uint64_t, <br class="typebreak" />
Protocol::Raft::Configuration &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1ConfigurationManager.html#a1b0e9174e1e054fdb2f6ec398575900b">descriptions</a></td></tr>
<tr class="memdesc:a1b0e9174e1e054fdb2f6ec398575900b"><td class="mdescLeft">&#160;</td><td class="mdescRight">This contains all the cluster configurations found in the log, plus one additional configuration from the latest snapshot.  <a href="#a1b0e9174e1e054fdb2f6ec398575900b">More...</a><br /></td></tr>
<tr class="separator:a1b0e9174e1e054fdb2f6ec398575900b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0219706f5f3f19733f82f6330ad49383"><td class="memItemLeft" align="right" valign="top">std::pair&lt; uint64_t, <br class="typebreak" />
Protocol::Raft::Configuration &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1ConfigurationManager.html#a0219706f5f3f19733f82f6330ad49383">snapshot</a></td></tr>
<tr class="memdesc:a0219706f5f3f19733f82f6330ad49383"><td class="mdescLeft">&#160;</td><td class="mdescRight">This reflects the configuration found in this server's latest snapshot, or {0, {}} if this server has no snapshot.  <a href="#a0219706f5f3f19733f82f6330ad49383">More...</a><br /></td></tr>
<tr class="separator:a0219706f5f3f19733f82f6330ad49383"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="friends"></a>
Friends</h2></td></tr>
<tr class="memitem:afe377268e20d0a8f20b104c2b0f51a2f"><td class="memItemLeft" align="right" valign="top">class&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1ConfigurationManager.html#afe377268e20d0a8f20b104c2b0f51a2f">Invariants</a></td></tr>
<tr class="separator:afe377268e20d0a8f20b104c2b0f51a2f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Ensures the current configuration reflects the latest state of the log and snapshot. </p>

<p>Definition at line <a class="el" href="RaftConsensus_8h_source.html#l00651">651</a> of file <a class="el" href="RaftConsensus_8h_source.html">RaftConsensus.h</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a20dde8951e005beb38d1fc337042e1e3"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">LogCabin::Server::RaftConsensusInternal::ConfigurationManager::ConfigurationManager </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Configuration.html">Configuration</a> &amp;&#160;</td>
          <td class="paramname"><em>configuration</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">explicit</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Constructor. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">configuration</td><td>The configuration that this object is in charge of setting. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="RaftConsensus_8cc_source.html#l00645">645</a> of file <a class="el" href="RaftConsensus_8cc_source.html">RaftConsensus.cc</a>.</p>

</div>
</div>
<a class="anchor" id="abb9e78257346313f89d479aad1cf360f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">LogCabin::Server::RaftConsensusInternal::ConfigurationManager::~ConfigurationManager </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Destructor. </p>

<p>Definition at line <a class="el" href="RaftConsensus_8cc_source.html#l00652">652</a> of file <a class="el" href="RaftConsensus_8cc_source.html">RaftConsensus.cc</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="aff783eca177f6fbbc4d3bd6d799859c0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void LogCabin::Server::RaftConsensusInternal::ConfigurationManager::add </td>
          <td>(</td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Protocol::Raft::Configuration &amp;&#160;</td>
          <td class="paramname"><em>description</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Called when a new configuration is added to the log. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">index</td><td>The log index of this configuration (equivalently, its ID). </td></tr>
    <tr><td class="paramname">description</td><td>The serializable representation of the configuration. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="RaftConsensus_8cc_source.html#l00657">657</a> of file <a class="el" href="RaftConsensus_8cc_source.html">RaftConsensus.cc</a>.</p>

</div>
</div>
<a class="anchor" id="a9f31a1182a01209770403dbb49423476"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void LogCabin::Server::RaftConsensusInternal::ConfigurationManager::truncatePrefix </td>
          <td>(</td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>firstIndexKept</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Called when a log prefix is truncated (after saving a snapshot that covers this prefix). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">firstIndexKept</td><td>The log entries in range [1, firstIndexKept) are being discarded. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="RaftConsensus_8cc_source.html#l00666">666</a> of file <a class="el" href="RaftConsensus_8cc_source.html">RaftConsensus.cc</a>.</p>

</div>
</div>
<a class="anchor" id="a2dc9ed6d199ba92faaeabf99f3f92e11"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void LogCabin::Server::RaftConsensusInternal::ConfigurationManager::truncateSuffix </td>
          <td>(</td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>lastIndexKept</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Called when a log suffix is truncated (when the leader doesn't agree with this server's log). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">lastIndexKept</td><td>The log entries in range (lastIndexKept, infinity) are being discarded. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="RaftConsensus_8cc_source.html#l00674">674</a> of file <a class="el" href="RaftConsensus_8cc_source.html">RaftConsensus.cc</a>.</p>

</div>
</div>
<a class="anchor" id="a9f2af8ae5b725e85ec6bccd788538ab9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void LogCabin::Server::RaftConsensusInternal::ConfigurationManager::setSnapshot </td>
          <td>(</td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Protocol::Raft::Configuration &amp;&#160;</td>
          <td class="paramname"><em>description</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Called when a new snapshot is saved. </p>
<p>Only the latest such configuration is kept. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">index</td><td>The log index of this configuration (equivalently, its ID). </td></tr>
    <tr><td class="paramname">description</td><td>The serializable representation of the configuration. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="RaftConsensus_8cc_source.html#l00682">682</a> of file <a class="el" href="RaftConsensus_8cc_source.html">RaftConsensus.cc</a>.</p>

</div>
</div>
<a class="anchor" id="aeb27d1a3e2260fb6cca1c8367c98d3a4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::pair&lt; uint64_t, Protocol::Raft::Configuration &gt; LogCabin::Server::RaftConsensusInternal::ConfigurationManager::getLatestConfigurationAsOf </td>
          <td>(</td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>lastIncludedIndex</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return the configuration as of a particular log index. </p>
<p>This is useful when taking snapshots. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">lastIncludedIndex</td><td>Configurations greater than this index will be ignored. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The index and description of the configuration with the largest index in the range [1, lastIncludedIndex]. </dd></dl>

<p>Definition at line <a class="el" href="RaftConsensus_8cc_source.html#l00692">692</a> of file <a class="el" href="RaftConsensus_8cc_source.html">RaftConsensus.cc</a>.</p>

</div>
</div>
<a class="anchor" id="a4e4d61fe51a62f8293d4a5667d68a1cc"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void LogCabin::Server::RaftConsensusInternal::ConfigurationManager::restoreInvariants </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Helper function called after changing this object's state. </p>
<ul>
<li>Make sure the snapshot configuration is in the descriptions map.</li>
<li>Set configuration to the configuration with the largest index in the descriptions map, or reset it the map is empty. </li>
</ul>

<p>Definition at line <a class="el" href="RaftConsensus_8cc_source.html#l00708">708</a> of file <a class="el" href="RaftConsensus_8cc_source.html">RaftConsensus.cc</a>.</p>

</div>
</div>
<h2 class="groupheader">Friends And Related Function Documentation</h2>
<a class="anchor" id="afe377268e20d0a8f20b104c2b0f51a2f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">friend class <a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Invariants.html">Invariants</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="RaftConsensus_8h_source.html#l00748">748</a> of file <a class="el" href="RaftConsensus_8h_source.html">RaftConsensus.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a class="anchor" id="a855381f65214fe24d258989b099e0ddc"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Configuration.html">Configuration</a>&amp; LogCabin::Server::RaftConsensusInternal::ConfigurationManager::configuration</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Defines the servers that are part of the cluster. </p>
<p>See <a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Configuration.html" title="A configuration defines the servers that are part of the cluster. ">Configuration</a>. </p>

<p>Definition at line <a class="el" href="RaftConsensus_8h_source.html#l00725">725</a> of file <a class="el" href="RaftConsensus_8h_source.html">RaftConsensus.h</a>.</p>

</div>
</div>
<a class="anchor" id="a1b0e9174e1e054fdb2f6ec398575900b"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::map&lt;uint64_t, Protocol::Raft::Configuration&gt; LogCabin::Server::RaftConsensusInternal::ConfigurationManager::descriptions</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This contains all the cluster configurations found in the log, plus one additional configuration from the latest snapshot. </p>
<p>It is used to find the right configuration when taking a snapshot and truncating the end of the log. It must be kept consistent with the log when it is loaded, as the log grows, as it gets truncated from the beginning for snapshots, and as it gets truncated from the end upon conflicts with the leader.</p>
<p>The key is the entry ID where the configuration belongs in the log; the value is the serializable form of the configuration. </p>

<p>Definition at line <a class="el" href="RaftConsensus_8h_source.html#l00740">740</a> of file <a class="el" href="RaftConsensus_8h_source.html">RaftConsensus.h</a>.</p>

</div>
</div>
<a class="anchor" id="a0219706f5f3f19733f82f6330ad49383"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::pair&lt;uint64_t, Protocol::Raft::Configuration&gt; LogCabin::Server::RaftConsensusInternal::ConfigurationManager::snapshot</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This reflects the configuration found in this server's latest snapshot, or {0, {}} if this server has no snapshot. </p>

<p>Definition at line <a class="el" href="RaftConsensus_8h_source.html#l00746">746</a> of file <a class="el" href="RaftConsensus_8h_source.html">RaftConsensus.h</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>Server/<a class="el" href="RaftConsensus_8h_source.html">RaftConsensus.h</a></li>
<li>Server/<a class="el" href="RaftConsensus_8cc_source.html">RaftConsensus.cc</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri Nov 14 2014 13:49:45 for LogCabin by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.7
</small></address>
</body>
</html>
