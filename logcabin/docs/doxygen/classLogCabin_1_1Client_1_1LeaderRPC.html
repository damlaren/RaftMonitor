<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.7"/>
<title>LogCabin: LogCabin::Client::LeaderRPC Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">LogCabin
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.7 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespaceLogCabin.html">LogCabin</a></li><li class="navelem"><a class="el" href="namespaceLogCabin_1_1Client.html">Client</a></li><li class="navelem"><a class="el" href="classLogCabin_1_1Client_1_1LeaderRPC.html">LeaderRPC</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="classLogCabin_1_1Client_1_1LeaderRPC-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">LogCabin::Client::LeaderRPC Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>This is the implementation of <a class="el" href="classLogCabin_1_1Client_1_1LeaderRPCBase.html" title="This class is used to send RPCs from clients to the leader of the LogCabin cluster. ">LeaderRPCBase</a> that uses the <a class="el" href="namespaceLogCabin_1_1RPC.html">RPC</a> system.  
 <a href="classLogCabin_1_1Client_1_1LeaderRPC.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="LeaderRPC_8h_source.html">LeaderRPC.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for LogCabin::Client::LeaderRPC:</div>
<div class="dyncontent">
 <div class="center">
  <img src="classLogCabin_1_1Client_1_1LeaderRPC.png" usemap="#LogCabin::Client::LeaderRPC_map" alt=""/>
  <map id="LogCabin::Client::LeaderRPC_map" name="LogCabin::Client::LeaderRPC_map">
<area href="classLogCabin_1_1Client_1_1LeaderRPCBase.html" title="This class is used to send RPCs from clients to the leader of the LogCabin cluster. " alt="LogCabin::Client::LeaderRPCBase" shape="rect" coords="0,0,203,24"/>
</map>
 </div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:aae680fa1acd23dfcddf20741f49f9e45"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLogCabin_1_1Client_1_1LeaderRPC.html#aae680fa1acd23dfcddf20741f49f9e45">LeaderRPC</a> (const <a class="el" href="classLogCabin_1_1RPC_1_1Address.html">RPC::Address</a> &amp;<a class="el" href="classLogCabin_1_1Client_1_1LeaderRPC.html#acd9136a4af974de121641e6d3ee8938f">hosts</a>)</td></tr>
<tr class="memdesc:aae680fa1acd23dfcddf20741f49f9e45"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor.  <a href="#aae680fa1acd23dfcddf20741f49f9e45">More...</a><br /></td></tr>
<tr class="separator:aae680fa1acd23dfcddf20741f49f9e45"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e43fcbc01c0f4d32884c4e092a4569e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLogCabin_1_1Client_1_1LeaderRPC.html#a4e43fcbc01c0f4d32884c4e092a4569e">~LeaderRPC</a> ()</td></tr>
<tr class="memdesc:a4e43fcbc01c0f4d32884c4e092a4569e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor.  <a href="#a4e43fcbc01c0f4d32884c4e092a4569e">More...</a><br /></td></tr>
<tr class="separator:a4e43fcbc01c0f4d32884c4e092a4569e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2a4c0859ef6765dc0e65888d80bcd3d8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLogCabin_1_1Client_1_1LeaderRPC.html#a2a4c0859ef6765dc0e65888d80bcd3d8">call</a> (<a class="el" href="classLogCabin_1_1Client_1_1LeaderRPCBase.html#a14f24cc35ca8d17a1df4f0ada9a569f7">OpCode</a> opCode, const google::protobuf::Message &amp;request, google::protobuf::Message &amp;response)</td></tr>
<tr class="memdesc:a2a4c0859ef6765dc0e65888d80bcd3d8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Execute an <a class="el" href="namespaceLogCabin_1_1RPC.html">RPC</a> on the cluster leader.  <a href="#a2a4c0859ef6765dc0e65888d80bcd3d8">More...</a><br /></td></tr>
<tr class="separator:a2a4c0859ef6765dc0e65888d80bcd3d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classLogCabin_1_1Client_1_1LeaderRPCBase"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classLogCabin_1_1Client_1_1LeaderRPCBase')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classLogCabin_1_1Client_1_1LeaderRPCBase.html">LogCabin::Client::LeaderRPCBase</a></td></tr>
<tr class="memitem:a2b7c9e50fbb14282380c4b613ad3c627 inherit pub_methods_classLogCabin_1_1Client_1_1LeaderRPCBase"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLogCabin_1_1Client_1_1LeaderRPCBase.html#a2b7c9e50fbb14282380c4b613ad3c627">LeaderRPCBase</a> ()</td></tr>
<tr class="memdesc:a2b7c9e50fbb14282380c4b613ad3c627 inherit pub_methods_classLogCabin_1_1Client_1_1LeaderRPCBase"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor.  <a href="#a2b7c9e50fbb14282380c4b613ad3c627">More...</a><br /></td></tr>
<tr class="separator:a2b7c9e50fbb14282380c4b613ad3c627 inherit pub_methods_classLogCabin_1_1Client_1_1LeaderRPCBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a551ad156d3c6a14ccfb707d28be37510 inherit pub_methods_classLogCabin_1_1Client_1_1LeaderRPCBase"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLogCabin_1_1Client_1_1LeaderRPCBase.html#a551ad156d3c6a14ccfb707d28be37510">~LeaderRPCBase</a> ()</td></tr>
<tr class="memdesc:a551ad156d3c6a14ccfb707d28be37510 inherit pub_methods_classLogCabin_1_1Client_1_1LeaderRPCBase"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor.  <a href="#a551ad156d3c6a14ccfb707d28be37510">More...</a><br /></td></tr>
<tr class="separator:a551ad156d3c6a14ccfb707d28be37510 inherit pub_methods_classLogCabin_1_1Client_1_1LeaderRPCBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0bae9ebb881e5540fdb1a082e95e1ee9 inherit pub_methods_classLogCabin_1_1Client_1_1LeaderRPCBase"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLogCabin_1_1Client_1_1LeaderRPCBase.html#a0bae9ebb881e5540fdb1a082e95e1ee9">LeaderRPCBase</a> (const <a class="el" href="classLogCabin_1_1Client_1_1LeaderRPCBase.html">LeaderRPCBase</a> &amp;)=delete</td></tr>
<tr class="separator:a0bae9ebb881e5540fdb1a082e95e1ee9 inherit pub_methods_classLogCabin_1_1Client_1_1LeaderRPCBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab49d2df24d5d936ab54ae72592e50322 inherit pub_methods_classLogCabin_1_1Client_1_1LeaderRPCBase"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classLogCabin_1_1Client_1_1LeaderRPCBase.html">LeaderRPCBase</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLogCabin_1_1Client_1_1LeaderRPCBase.html#ab49d2df24d5d936ab54ae72592e50322">operator=</a> (const <a class="el" href="classLogCabin_1_1Client_1_1LeaderRPCBase.html">LeaderRPCBase</a> &amp;)=delete</td></tr>
<tr class="separator:ab49d2df24d5d936ab54ae72592e50322 inherit pub_methods_classLogCabin_1_1Client_1_1LeaderRPCBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:abae51cda85b95e52906a00563fed7ab0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLogCabin_1_1Client_1_1LeaderRPC.html#abae51cda85b95e52906a00563fed7ab0">handleServiceSpecificError</a> (std::shared_ptr&lt; <a class="el" href="classLogCabin_1_1RPC_1_1ClientSession.html">RPC::ClientSession</a> &gt; cachedSession, const Protocol::Client::Error &amp;error)</td></tr>
<tr class="memdesc:abae51cda85b95e52906a00563fed7ab0"><td class="mdescLeft">&#160;</td><td class="mdescRight">A helper for <a class="el" href="classLogCabin_1_1Client_1_1LeaderRPC.html#a2a4c0859ef6765dc0e65888d80bcd3d8" title="Execute an RPC on the cluster leader. ">call()</a> that decodes errors thrown by the service.  <a href="#abae51cda85b95e52906a00563fed7ab0">More...</a><br /></td></tr>
<tr class="separator:abae51cda85b95e52906a00563fed7ab0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9f1a72e989279fb8ca46318a1af40821"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLogCabin_1_1Client_1_1LeaderRPC.html#a9f1a72e989279fb8ca46318a1af40821">connect</a> (const <a class="el" href="classLogCabin_1_1RPC_1_1Address.html">RPC::Address</a> &amp;address, std::unique_lock&lt; std::mutex &gt; &amp;lockGuard)</td></tr>
<tr class="memdesc:a9f1a72e989279fb8ca46318a1af40821"><td class="mdescLeft">&#160;</td><td class="mdescRight">Connect to a new host in hopes that it is the cluster leader.  <a href="#a9f1a72e989279fb8ca46318a1af40821">More...</a><br /></td></tr>
<tr class="separator:a9f1a72e989279fb8ca46318a1af40821"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac97d153a2a9d173cc986940eda406b9b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLogCabin_1_1Client_1_1LeaderRPC.html#ac97d153a2a9d173cc986940eda406b9b">connectRandom</a> (std::shared_ptr&lt; <a class="el" href="classLogCabin_1_1RPC_1_1ClientSession.html">RPC::ClientSession</a> &gt; cachedSession)</td></tr>
<tr class="memdesc:ac97d153a2a9d173cc986940eda406b9b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Connect to a random host in <a class="el" href="classLogCabin_1_1Client_1_1LeaderRPC.html#acd9136a4af974de121641e6d3ee8938f" title="An address referring to the hosts in the LogCabin cluster. ">hosts</a> in hopes that it is the cluster leader.  <a href="#ac97d153a2a9d173cc986940eda406b9b">More...</a><br /></td></tr>
<tr class="separator:ac97d153a2a9d173cc986940eda406b9b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a453974f4dacb3d327c2dfd1145572678"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLogCabin_1_1Client_1_1LeaderRPC.html#a453974f4dacb3d327c2dfd1145572678">connectHost</a> (const std::string &amp;host, std::shared_ptr&lt; <a class="el" href="classLogCabin_1_1RPC_1_1ClientSession.html">RPC::ClientSession</a> &gt; cachedSession)</td></tr>
<tr class="memdesc:a453974f4dacb3d327c2dfd1145572678"><td class="mdescLeft">&#160;</td><td class="mdescRight">Connect to a specific host in hopes that it is the cluster leader.  <a href="#a453974f4dacb3d327c2dfd1145572678">More...</a><br /></td></tr>
<tr class="separator:a453974f4dacb3d327c2dfd1145572678"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:acd9136a4af974de121641e6d3ee8938f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classLogCabin_1_1RPC_1_1Address.html">RPC::Address</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLogCabin_1_1Client_1_1LeaderRPC.html#acd9136a4af974de121641e6d3ee8938f">hosts</a></td></tr>
<tr class="memdesc:acd9136a4af974de121641e6d3ee8938f"><td class="mdescLeft">&#160;</td><td class="mdescRight">An address referring to the hosts in the <a class="el" href="namespaceLogCabin.html">LogCabin</a> cluster.  <a href="#acd9136a4af974de121641e6d3ee8938f">More...</a><br /></td></tr>
<tr class="separator:acd9136a4af974de121641e6d3ee8938f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa7d17b3b059ebcf3591f126ac1933bc0"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classLogCabin_1_1Event_1_1Loop.html">Event::Loop</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLogCabin_1_1Client_1_1LeaderRPC.html#aa7d17b3b059ebcf3591f126ac1933bc0">eventLoop</a></td></tr>
<tr class="memdesc:aa7d17b3b059ebcf3591f126ac1933bc0"><td class="mdescLeft">&#160;</td><td class="mdescRight">The <a class="el" href="classLogCabin_1_1Event_1_1Loop.html" title="This class contains an event loop based on Linux&#39;s epoll interface. ">Event::Loop</a> used to drive the underlying <a class="el" href="namespaceLogCabin_1_1RPC.html">RPC</a> mechanism.  <a href="#aa7d17b3b059ebcf3591f126ac1933bc0">More...</a><br /></td></tr>
<tr class="separator:aa7d17b3b059ebcf3591f126ac1933bc0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa367c6dd7a8bd0fed505190ddb1e8b73"><td class="memItemLeft" align="right" valign="top">std::thread&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLogCabin_1_1Client_1_1LeaderRPC.html#aa367c6dd7a8bd0fed505190ddb1e8b73">eventLoopThread</a></td></tr>
<tr class="memdesc:aa367c6dd7a8bd0fed505190ddb1e8b73"><td class="mdescLeft">&#160;</td><td class="mdescRight">A thread that runs the <a class="el" href="classLogCabin_1_1Event_1_1Loop.html" title="This class contains an event loop based on Linux&#39;s epoll interface. ">Event::Loop</a>.  <a href="#aa367c6dd7a8bd0fed505190ddb1e8b73">More...</a><br /></td></tr>
<tr class="separator:aa367c6dd7a8bd0fed505190ddb1e8b73"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7138a39c8bce5a72e4a1a10cc1cff827"><td class="memItemLeft" align="right" valign="top">std::mutex&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLogCabin_1_1Client_1_1LeaderRPC.html#a7138a39c8bce5a72e4a1a10cc1cff827">mutex</a></td></tr>
<tr class="memdesc:a7138a39c8bce5a72e4a1a10cc1cff827"><td class="mdescLeft">&#160;</td><td class="mdescRight">Protects <a class="el" href="classLogCabin_1_1Client_1_1LeaderRPC.html#a8f9cf29935a2916dfd68877f60052e61" title="The goal is to get this session connected to the cluster leader. ">leaderSession</a>.  <a href="#a7138a39c8bce5a72e4a1a10cc1cff827">More...</a><br /></td></tr>
<tr class="separator:a7138a39c8bce5a72e4a1a10cc1cff827"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8f9cf29935a2916dfd68877f60052e61"><td class="memItemLeft" align="right" valign="top">std::shared_ptr<br class="typebreak" />
&lt; <a class="el" href="classLogCabin_1_1RPC_1_1ClientSession.html">RPC::ClientSession</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLogCabin_1_1Client_1_1LeaderRPC.html#a8f9cf29935a2916dfd68877f60052e61">leaderSession</a></td></tr>
<tr class="memdesc:a8f9cf29935a2916dfd68877f60052e61"><td class="mdescLeft">&#160;</td><td class="mdescRight">The goal is to get this session connected to the cluster leader.  <a href="#a8f9cf29935a2916dfd68877f60052e61">More...</a><br /></td></tr>
<tr class="separator:a8f9cf29935a2916dfd68877f60052e61"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="inherited"></a>
Additional Inherited Members</h2></td></tr>
<tr class="inherit_header pub_types_classLogCabin_1_1Client_1_1LeaderRPCBase"><td colspan="2" onclick="javascript:toggleInherit('pub_types_classLogCabin_1_1Client_1_1LeaderRPCBase')"><img src="closed.png" alt="-"/>&#160;Public Types inherited from <a class="el" href="classLogCabin_1_1Client_1_1LeaderRPCBase.html">LogCabin::Client::LeaderRPCBase</a></td></tr>
<tr class="memitem:a14f24cc35ca8d17a1df4f0ada9a569f7 inherit pub_types_classLogCabin_1_1Client_1_1LeaderRPCBase"><td class="memItemLeft" align="right" valign="top">typedef Protocol::Client::OpCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLogCabin_1_1Client_1_1LeaderRPCBase.html#a14f24cc35ca8d17a1df4f0ada9a569f7">OpCode</a></td></tr>
<tr class="memdesc:a14f24cc35ca8d17a1df4f0ada9a569f7 inherit pub_types_classLogCabin_1_1Client_1_1LeaderRPCBase"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="namespaceLogCabin_1_1RPC.html">RPC</a> operation code.  <a href="#a14f24cc35ca8d17a1df4f0ada9a569f7">More...</a><br /></td></tr>
<tr class="separator:a14f24cc35ca8d17a1df4f0ada9a569f7 inherit pub_types_classLogCabin_1_1Client_1_1LeaderRPCBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This is the implementation of <a class="el" href="classLogCabin_1_1Client_1_1LeaderRPCBase.html" title="This class is used to send RPCs from clients to the leader of the LogCabin cluster. ">LeaderRPCBase</a> that uses the <a class="el" href="namespaceLogCabin_1_1RPC.html">RPC</a> system. </p>
<p>(The other implementation, <a class="el" href="classLogCabin_1_1Client_1_1LeaderRPCMock.html" title="This class is used in unit testing to interpose when clients send RPCs to the leader of the LogCabin ...">LeaderRPCMock</a>, is only used for testing.) </p>

<p>Definition at line <a class="el" href="LeaderRPC_8h_source.html#l00084">84</a> of file <a class="el" href="LeaderRPC_8h_source.html">LeaderRPC.h</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="aae680fa1acd23dfcddf20741f49f9e45"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">LogCabin::Client::LeaderRPC::LeaderRPC </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classLogCabin_1_1RPC_1_1Address.html">RPC::Address</a> &amp;&#160;</td>
          <td class="paramname"><em>hosts</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">explicit</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Constructor. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">hosts</td><td>Describe the servers to connect to. This class assumes that refreshing 'hosts' will result in a random host that might be the current cluster leader. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="LeaderRPC_8cc_source.html#l00027">27</a> of file <a class="el" href="LeaderRPC_8cc_source.html">LeaderRPC.cc</a>.</p>

</div>
</div>
<a class="anchor" id="a4e43fcbc01c0f4d32884c4e092a4569e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">LogCabin::Client::LeaderRPC::~LeaderRPC </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Destructor. </p>

<p>Definition at line <a class="el" href="LeaderRPC_8cc_source.html#l00038">38</a> of file <a class="el" href="LeaderRPC_8cc_source.html">LeaderRPC.cc</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a2a4c0859ef6765dc0e65888d80bcd3d8"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void LogCabin::Client::LeaderRPC::call </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classLogCabin_1_1Client_1_1LeaderRPCBase.html#a14f24cc35ca8d17a1df4f0ada9a569f7">OpCode</a>&#160;</td>
          <td class="paramname"><em>opCode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const google::protobuf::Message &amp;&#160;</td>
          <td class="paramname"><em>request</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">google::protobuf::Message &amp;&#160;</td>
          <td class="paramname"><em>response</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Execute an <a class="el" href="namespaceLogCabin_1_1RPC.html">RPC</a> on the cluster leader. </p>
<p>This class guarantees that the <a class="el" href="namespaceLogCabin_1_1RPC.html">RPC</a> will be executed at least once. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">opCode</td><td><a class="el" href="namespaceLogCabin_1_1RPC.html">RPC</a> operation code. The caller must guarantee that this is a valid opCode. (If the server rejects it, this will PANIC.) </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">request</td><td>The parameters for the operation. The caller must guarantee that this is a well-formed request. (If the server rejects it, this will PANIC.) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">response</td><td>The response to the operation will be filled in here. </td></tr>
  </table>
  </dd>
</dl>

<p>Implements <a class="el" href="classLogCabin_1_1Client_1_1LeaderRPCBase.html#a3eddd989c0bdf72fc16898a3bf28fb8e">LogCabin::Client::LeaderRPCBase</a>.</p>

<p>Definition at line <a class="el" href="LeaderRPC_8cc_source.html#l00047">47</a> of file <a class="el" href="LeaderRPC_8cc_source.html">LeaderRPC.cc</a>.</p>

</div>
</div>
<a class="anchor" id="abae51cda85b95e52906a00563fed7ab0"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void LogCabin::Client::LeaderRPC::handleServiceSpecificError </td>
          <td>(</td>
          <td class="paramtype">std::shared_ptr&lt; <a class="el" href="classLogCabin_1_1RPC_1_1ClientSession.html">RPC::ClientSession</a> &gt;&#160;</td>
          <td class="paramname"><em>cachedSession</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Protocol::Client::Error &amp;&#160;</td>
          <td class="paramname"><em>error</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>A helper for <a class="el" href="classLogCabin_1_1Client_1_1LeaderRPC.html#a2a4c0859ef6765dc0e65888d80bcd3d8" title="Execute an RPC on the cluster leader. ">call()</a> that decodes errors thrown by the service. </p>

<p>Definition at line <a class="el" href="LeaderRPC_8cc_source.html#l00089">89</a> of file <a class="el" href="LeaderRPC_8cc_source.html">LeaderRPC.cc</a>.</p>

</div>
</div>
<a class="anchor" id="a9f1a72e989279fb8ca46318a1af40821"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void LogCabin::Client::LeaderRPC::connect </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classLogCabin_1_1RPC_1_1Address.html">RPC::Address</a> &amp;&#160;</td>
          <td class="paramname"><em>address</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::unique_lock&lt; std::mutex &gt; &amp;&#160;</td>
          <td class="paramname"><em>lockGuard</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Connect to a new host in hopes that it is the cluster leader. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">address</td><td>The host to connect to. </td></tr>
    <tr><td class="paramname">lockGuard</td><td>Proof that the caller is holding <a class="el" href="classLogCabin_1_1Client_1_1LeaderRPC.html#a7138a39c8bce5a72e4a1a10cc1cff827" title="Protects leaderSession. ">mutex</a>. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="LeaderRPC_8cc_source.html#l00123">123</a> of file <a class="el" href="LeaderRPC_8cc_source.html">LeaderRPC.cc</a>.</p>

</div>
</div>
<a class="anchor" id="ac97d153a2a9d173cc986940eda406b9b"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void LogCabin::Client::LeaderRPC::connectRandom </td>
          <td>(</td>
          <td class="paramtype">std::shared_ptr&lt; <a class="el" href="classLogCabin_1_1RPC_1_1ClientSession.html">RPC::ClientSession</a> &gt;&#160;</td>
          <td class="paramname"><em>cachedSession</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Connect to a random host in <a class="el" href="classLogCabin_1_1Client_1_1LeaderRPC.html#acd9136a4af974de121641e6d3ee8938f" title="An address referring to the hosts in the LogCabin cluster. ">hosts</a> in hopes that it is the cluster leader. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cachedSession</td><td>This operation will only disconnect the current session if it is the same as the session that is provided here. This is used to detect races in which some other thread has already solved the problem. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="LeaderRPC_8cc_source.html#l00133">133</a> of file <a class="el" href="LeaderRPC_8cc_source.html">LeaderRPC.cc</a>.</p>

</div>
</div>
<a class="anchor" id="a453974f4dacb3d327c2dfd1145572678"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void LogCabin::Client::LeaderRPC::connectHost </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>host</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::shared_ptr&lt; <a class="el" href="classLogCabin_1_1RPC_1_1ClientSession.html">RPC::ClientSession</a> &gt;&#160;</td>
          <td class="paramname"><em>cachedSession</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Connect to a specific host in hopes that it is the cluster leader. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">host</td><td>A string describing the host to connect to. This is passed in string form rather than as an Address, which might save a DNS lookup in case cachedSession turns out to be stale. </td></tr>
    <tr><td class="paramname">cachedSession</td><td>This operation will only disconnect the current session if it is the same as the session that is provided here. This is used to detect races in which some other thread has already solved the problem. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="LeaderRPC_8cc_source.html#l00145">145</a> of file <a class="el" href="LeaderRPC_8cc_source.html">LeaderRPC.cc</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a class="anchor" id="acd9136a4af974de121641e6d3ee8938f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classLogCabin_1_1RPC_1_1Address.html">RPC::Address</a> LogCabin::Client::LeaderRPC::hosts</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>An address referring to the hosts in the <a class="el" href="namespaceLogCabin.html">LogCabin</a> cluster. </p>
<p>A random host is selected from here when this class doesn't know who the cluster leader is. </p>

<p>Definition at line <a class="el" href="LeaderRPC_8h_source.html#l00154">154</a> of file <a class="el" href="LeaderRPC_8h_source.html">LeaderRPC.h</a>.</p>

</div>
</div>
<a class="anchor" id="aa7d17b3b059ebcf3591f126ac1933bc0"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classLogCabin_1_1Event_1_1Loop.html">Event::Loop</a> LogCabin::Client::LeaderRPC::eventLoop</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The <a class="el" href="classLogCabin_1_1Event_1_1Loop.html" title="This class contains an event loop based on Linux&#39;s epoll interface. ">Event::Loop</a> used to drive the underlying <a class="el" href="namespaceLogCabin_1_1RPC.html">RPC</a> mechanism. </p>

<p>Definition at line <a class="el" href="LeaderRPC_8h_source.html#l00159">159</a> of file <a class="el" href="LeaderRPC_8h_source.html">LeaderRPC.h</a>.</p>

</div>
</div>
<a class="anchor" id="aa367c6dd7a8bd0fed505190ddb1e8b73"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::thread LogCabin::Client::LeaderRPC::eventLoopThread</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>A thread that runs the <a class="el" href="classLogCabin_1_1Event_1_1Loop.html" title="This class contains an event loop based on Linux&#39;s epoll interface. ">Event::Loop</a>. </p>

<p>Definition at line <a class="el" href="LeaderRPC_8h_source.html#l00164">164</a> of file <a class="el" href="LeaderRPC_8h_source.html">LeaderRPC.h</a>.</p>

</div>
</div>
<a class="anchor" id="a7138a39c8bce5a72e4a1a10cc1cff827"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::mutex LogCabin::Client::LeaderRPC::mutex</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Protects <a class="el" href="classLogCabin_1_1Client_1_1LeaderRPC.html#a8f9cf29935a2916dfd68877f60052e61" title="The goal is to get this session connected to the cluster leader. ">leaderSession</a>. </p>
<p>Threads hang on to this mutex while initiating new sessions to possible cluster leaders, in case other threads are already handling the problem. </p>

<p>Definition at line <a class="el" href="LeaderRPC_8h_source.html#l00171">171</a> of file <a class="el" href="LeaderRPC_8h_source.html">LeaderRPC.h</a>.</p>

</div>
</div>
<a class="anchor" id="a8f9cf29935a2916dfd68877f60052e61"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::shared_ptr&lt;<a class="el" href="classLogCabin_1_1RPC_1_1ClientSession.html">RPC::ClientSession</a>&gt; LogCabin::Client::LeaderRPC::leaderSession</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The goal is to get this session connected to the cluster leader. </p>
<p>This is never null, but it might sometimes point to the wrong host. </p>

<p>Definition at line <a class="el" href="LeaderRPC_8h_source.html#l00177">177</a> of file <a class="el" href="LeaderRPC_8h_source.html">LeaderRPC.h</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>Client/<a class="el" href="LeaderRPC_8h_source.html">LeaderRPC.h</a></li>
<li>Client/<a class="el" href="LeaderRPC_8cc_source.html">LeaderRPC.cc</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri Nov 14 2014 13:49:45 for LogCabin by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.7
</small></address>
</body>
</html>
